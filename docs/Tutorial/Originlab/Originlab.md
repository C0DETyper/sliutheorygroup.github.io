# Origin 作图
作者：林子越  

## 一、VASP 作图

### 1. 能带

1. 将 `bnd.dat` 拖入 Origin。  
   ![](media/a93a608f4f10f80fce8951449592b916.png)

2. 点击左下角折线图图标，设置 **A 列为 X，B 列及以后为 Y**。  
   ![](media/4b71cf538bd6bbb48236e599199cd17a.png)

3. 右键「应用设定到当前行及其下面所有行」，然后确定绘图。

4. 双击坐标轴进行如下修改：  

#### （1）刻度

- 水平范围：0 – *x* 轴最大值。  
- 垂直范围：与 DOS 图 *x* 轴范围一致。  
- 水平主刻度 →「按自定义位置」，输入 5 个高对称点对应的 *k*-path 值（例如第 1, 21, 41, 61, 81 行）。  

#### （2）刻度线标签

- 下轴类型：刻度索引字符串。  
- 依次输入：`X   R   M   Γ   R`。  

#### （3）标题

左轴文本改为 `E (eV)`。

#### （4）轴线与刻度线

- 下 / 右 / 上轴仅显示轴线与刻度线，主次刻度样式均设为「无」。  
- 保留左轴刻度。

#### （5）参照线

- 方式与自定义刻度相同，输入后点击「插入」→「细节」。  
- 选中全部参照线，取消「自动格式」，样式设为实线、颜色黑色、宽度 1.5 pt。

#### （6）调整图线

- 点击右侧反锯齿图标使线条平滑。  
- 双击线条 →「线条」页 → 宽度 1 pt。

#### （7）调整画布

双击空白处 →「大小/速度」页，可修改位置和尺寸。



### 2. 态密度（DOS）

#### （1）总态密度

1. 导入 `DOS_total.dat`。  
2. 仅选 **A 列 (X) 与 B 列 (Y)** 绘图。  
3. 若需与能带图合并，先点击「交换 X–Y 轴」。  
4. 如需填充效果：  
   - 选中曲线 →「填充曲线之下的区域」。  
   - 「图案」页选择颜色或填充图案。

#### （2）能带 + DOS 合并

1. 依次选中两幅图 → 菜单「图 > 合并图表」。  
2. 布局：1 行 × 2 列；勾选「用统一尺度设置图册高度」。  
3. 微调图表大小或使用方向键对齐。

---

### 3. phonopy 声子谱

1. 将 `band.dat` 拖入 Origin，步骤同能带图。  
2. 高对称点 *k*-path 需自行从 `band.yml` 中提取：

```bash
# vi 打开 band.yml 后，在命令模式下：
/0.5000000, 0.5000000, 0.5000000   # 自上而下搜索
?0.5000000, 0.5000000, 0.5000000   # 自下而上搜索
```

`distance:` 字段即为横坐标。

---

### 4. phonopy 声子态密度

将 `total_dos.dat` 拖入 Origin，合并步骤与「能带 + DOS」相同。

---

## 二、CASTEP 作图

### 1. 能带

```bash
Dispersion.pl -bs *.bands > band.txt
```

- 将生成的 `band.txt` 拖入 Origin。  
- **E 列** 为 X 轴，之后各列为 Y 轴；B/C/D 为 *k* 点，请勿作图。  
- 高对称点：在 B/C/D 列找到坐标行，其 E 列值即为 *k*-path 横坐标。  
- 费米能：在 `.castep` 文件中搜索 `fermi` 后手动减去。

### 2. DOS / PDOS

- DOS：操作同 VASP。  
- PDOS：第一列为 X，之后为各投影 Y。

### 3. 声子谱

```bash
dispersion.pl F.phonon > phonon.txt
```

绘图方法同能带，仍需忽略第 2–4 列的 *k* 点数据。

---

## 三、Quantum Espresso 作图

### 1. 声子谱

- 使用输出文件 `F.freq.gp` 作图。  
- 若五个高对称点、每段插入 20 个 *k* 点，则高对称点横坐标对应第 1, 21, 41, 61, 81 行第一列。

### 2. 声子态密度

`phdos.dat` 直接绘图，无特殊设置。

---

## 四、AirSS / run.pl 二元凸包-焓差图

### 1. 数据准备

```bash
ca -m      # 生成能量/焓数据表
```

若两端为单质，纵坐标直接使用 `ca -m` 第四列右侧的平均原子焓。  
若端点含化合物（例：左端 RbF，右端 F）：

- 计算 *RbFₓ* 的总焓差：  
  ```text
  ΔH_total = E(RbFₓ) − x·E(Rb) − E(F)
  ```
- 平均焓差：`ΔH_total / (x + 1)`。

### 2. Origin 设置

1. 第一列：化合物中 F 原子数 *x*（单元素变化时为 1）。  
2. 第二列：F 原子占比。  
3. 第三列 C(Y)：对应压力点的 `ca -m` 第四列左侧焓值。  
4. 第四列 D(Y)：右键「设置列值」，输入公式计算平均焓差。  
5. E–H 列：其他压力点。  
6. I–K 列：复制落在凸包上的结构焓值（`ca -m` 第六列为 `+` 或 `0.000`）。

### 3. 绘制凸包

- 打开「格式 > 页面属性 > 显示」，勾选「跨缺失数据连接直线」。  
- 双击直线可调整样式、粗细与颜色。  
- 标注可复制图例文本或「插入 > 文本」。  

最终美化：  
- 线条「组 > 编辑模式」设为「独立」。  
- I–K 列符号大小 0，线型实线并加粗，其他列虚线。

---

## 五、凸包图与相图示例

示例文件：`convex.opju`、`phase-diag.opgu`。  
相图采用「浮动条形图」；按 `Ctrl` + 左键可为单段设置颜色。  
分段刻度：双击刻度查看取点方法。

---

（完）